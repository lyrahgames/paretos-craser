#pragma once
#include <craser/utility.hpp>

namespace craser::cr_zn_se {

constexpr auto emission_cross_section(real wavelength) noexcept {
  constexpr pair<real, real> data[] = {
      {1.2430e+00, 0.0000e+00},  {1.2455e+00, 1.1200e-21},
      {1.2481e+00, 1.1200e-21},  {1.2506e+00, 1.1200e-21},
      {1.2532e+00, 1.1200e-21},  {1.2557e+00, 1.1200e-21},
      {1.2583e+00, 1.1200e-21},  {1.2608e+00, 1.1200e-21},
      {1.2634e+00, 1.1200e-21},  {1.2659e+00, 1.1200e-21},
      {1.2684e+00, 1.1200e-21},  {1.2710e+00, 2.2400e-21},
      {1.2735e+00, 2.2400e-21},  {1.2761e+00, 3.3600e-21},
      {1.2786e+00, 4.4800e-21},  {1.2812e+00, 4.4800e-21},
      {1.2837e+00, 4.4800e-21},  {1.2863e+00, 5.6000e-21},
      {1.2888e+00, 6.7200e-21},  {1.2913e+00, 6.7200e-21},
      {1.2939e+00, 7.8400e-21},  {1.2964e+00, 8.9600e-21},
      {1.2990e+00, 8.9600e-21},  {1.3015e+00, 1.1200e-20},
      {1.3041e+00, 1.2320e-20},  {1.3066e+00, 1.3440e-20},
      {1.3092e+00, 1.5680e-20},  {1.3117e+00, 1.5680e-20},
      {1.3142e+00, 1.6800e-20},  {1.3346e+00, 3.5840e-20},
      {1.3372e+00, 3.6960e-20},  {1.3397e+00, 3.6960e-20},
      {1.3422e+00, 3.6960e-20},  {1.3550e+00, 5.9360e-20},
      {1.3575e+00, 6.0480e-20},  {1.3601e+00, 6.2720e-20},
      {1.3626e+00, 6.4960e-20},  {1.3651e+00, 6.7200e-20},
      {1.3677e+00, 7.1680e-20},  {1.3702e+00, 7.5040e-20},
      {1.3728e+00, 8.0640e-20},  {1.3753e+00, 8.2880e-20},
      {1.3779e+00, 8.7360e-20},  {1.3804e+00, 9.1840e-20},
      {1.3830e+00, 9.6320e-20},  {1.3855e+00, 1.0080e-19},
      {1.3880e+00, 1.0416e-19},  {1.3906e+00, 1.0864e-19},
      {1.3931e+00, 1.1536e-19},  {1.3957e+00, 1.1872e-19},
      {1.3982e+00, 1.2432e-19},  {1.4008e+00, 1.2880e-19},
      {1.4033e+00, 1.3328e-19},  {1.4059e+00, 1.3664e-19},
      {1.4084e+00, 1.4112e-19},  {1.4109e+00, 1.4224e-19},
      {1.4135e+00, 1.4336e-19},  {1.4186e+00, 1.7808e-19},
      {1.4211e+00, 1.7808e-19},  {1.4237e+00, 1.7808e-19},
      {1.4262e+00, 1.7808e-19},  {1.4338e+00, 2.1392e-19},
      {1.4364e+00, 2.1616e-19},  {1.4389e+00, 2.1728e-19},
      {1.4415e+00, 2.2176e-19},  {1.4440e+00, 2.2624e-19},
      {1.4466e+00, 2.3296e-19},  {1.4491e+00, 2.3968e-19},
      {1.4517e+00, 2.4640e-19},  {1.4542e+00, 2.5312e-19},
      {1.4567e+00, 2.5984e-19},  {1.4593e+00, 2.6656e-19},
      {1.4618e+00, 2.7440e-19},  {1.4644e+00, 2.8112e-19},
      {1.4669e+00, 2.8784e-19},  {1.4695e+00, 2.9232e-19},
      {1.4720e+00, 2.9792e-19},  {1.4746e+00, 3.0016e-19},
      {1.4796e+00, 3.3600e-19},  {1.4822e+00, 3.3600e-19},
      {1.4847e+00, 3.3600e-19},  {1.4873e+00, 3.3600e-19},
      {1.4898e+00, 3.7184e-19},  {1.4924e+00, 3.7520e-19},
      {1.4949e+00, 3.7968e-19},  {1.4975e+00, 3.8192e-19},
      {1.5000e+00, 3.9200e-19},  {1.5025e+00, 3.9984e-19},
      {1.5051e+00, 4.0768e-19},  {1.5076e+00, 4.1552e-19},
      {1.5102e+00, 4.2560e-19},  {1.5127e+00, 4.3680e-19},
      {1.5153e+00, 4.4464e-19},  {1.5178e+00, 4.4912e-19},
      {1.5204e+00, 4.5360e-19},  {1.5229e+00, 4.5920e-19},
      {1.5254e+00, 4.9504e-19},  {1.5280e+00, 4.9504e-19},
      {1.5305e+00, 4.9392e-19},  {1.5331e+00, 5.1610e-19},
      {1.5356e+00, 5.3536e-19},  {1.5382e+00, 5.4208e-19},
      {1.5407e+00, 5.4544e-19},  {1.5433e+00, 5.5552e-19},
      {1.5458e+00, 5.6448e-19},  {1.5483e+00, 5.7680e-19},
      {1.5509e+00, 5.8912e-19},  {1.5534e+00, 5.9808e-19},
      {1.5560e+00, 6.0480e-19},  {1.5585e+00, 6.1040e-19},
      {1.5611e+00, 6.2208e-19},  {1.5636e+00, 6.5296e-19},
      {1.5662e+00, 6.5296e-19},  {1.5687e+00, 6.5408e-19},
      {1.5712e+00, 6.8395e-19},  {1.5738e+00, 6.9664e-19},
      {1.5763e+00, 7.0336e-19},  {1.5789e+00, 7.0896e-19},
      {1.5814e+00, 7.1904e-19},  {1.5840e+00, 7.2912e-19},
      {1.5865e+00, 7.4144e-19},  {1.5891e+00, 7.5264e-19},
      {1.5916e+00, 7.6160e-19},  {1.5941e+00, 7.6720e-19},
      {1.5967e+00, 7.7056e-19},  {1.6018e+00, 8.1200e-19},
      {1.6043e+00, 8.1200e-19},  {1.6069e+00, 8.1200e-19},
      {1.6094e+00, 8.4896e-19},  {1.6120e+00, 8.5120e-19},
      {1.6145e+00, 8.5792e-19},  {1.6170e+00, 8.6128e-19},
      {1.6196e+00, 8.7136e-19},  {1.6221e+00, 8.7808e-19},
      {1.6247e+00, 8.8816e-19},  {1.6272e+00, 8.9600e-19},
      {1.6298e+00, 9.0384e-19},  {1.6323e+00, 9.1280e-19},
      {1.6349e+00, 9.2064e-19},  {1.6374e+00, 9.2512e-19},
      {1.6399e+00, 9.2960e-19},  {1.6425e+00, 9.3296e-19},
      {1.6450e+00, 9.3520e-19},  {1.6527e+00, 9.6992e-19},
      {1.6552e+00, 9.7104e-19},  {1.6578e+00, 9.7104e-19},
      {1.6603e+00, 9.6992e-19},  {1.6781e+00, 9.9904e-19},
      {1.6807e+00, 1.0002e-18},  {1.6832e+00, 9.9904e-19},
      {1.6858e+00, 1.0002e-18},  {1.6883e+00, 1.0002e-18},
      {1.6908e+00, 1.0002e-18},  {1.6934e+00, 9.9904e-19},
      {1.6959e+00, 9.9680e-19},  {1.6985e+00, 9.9568e-19},
      {1.7010e+00, 9.9456e-19},  {1.7036e+00, 9.9344e-19},
      {1.7061e+00, 9.9120e-19},  {1.7087e+00, 9.9008e-19},
      {1.7112e+00, 9.8448e-19},  {1.7137e+00, 9.8112e-19},
      {1.7163e+00, 9.7776e-19},  {1.7188e+00, 9.7216e-19},
      {1.7214e+00, 9.6880e-19},  {1.7239e+00, 9.6208e-19},
      {1.7265e+00, 9.5760e-19},  {1.7290e+00, 9.5312e-19},
      {1.7316e+00, 9.4752e-19},  {1.7341e+00, 9.4080e-19},
      {1.7366e+00, 9.3520e-19},  {1.7392e+00, 9.3184e-19},
      {1.7417e+00, 9.2960e-19},  {1.7494e+00, 8.9152e-19},
      {1.7519e+00, 8.9264e-19},  {1.7545e+00, 8.9152e-19},
      {1.7595e+00, 8.5456e-19},  {1.7621e+00, 8.5120e-19},
      {1.7646e+00, 8.4560e-19},  {1.7672e+00, 8.4000e-19},
      {1.7697e+00, 8.3104e-19},  {1.7723e+00, 8.2096e-19},
      {1.7748e+00, 8.1312e-19},  {1.7774e+00, 8.0304e-19},
      {1.7799e+00, 7.9408e-19},  {1.7824e+00, 7.8512e-19},
      {1.7850e+00, 7.8064e-19},  {1.7875e+00, 7.7392e-19},
      {1.7901e+00, 7.5578e-19},  {1.7926e+00, 7.3360e-19},
      {1.7952e+00, 7.3360e-19},  {1.7977e+00, 7.3360e-19},
      {1.8003e+00, 6.9664e-19},  {1.8028e+00, 6.9104e-19},
      {1.8053e+00, 6.8432e-19},  {1.8079e+00, 6.7872e-19},
      {1.8104e+00, 6.6976e-19},  {1.8130e+00, 6.5856e-19},
      {1.8155e+00, 6.4512e-19},  {1.8181e+00, 6.3728e-19},
      {1.8206e+00, 6.2720e-19},  {1.8232e+00, 6.2160e-19},
      {1.8257e+00, 6.1600e-19},  {1.8282e+00, 6.0346e-19},
      {1.8308e+00, 5.7568e-19},  {1.8333e+00, 5.7456e-19},
      {1.8359e+00, 5.7568e-19},  {1.8384e+00, 5.3872e-19},
      {1.8410e+00, 5.3200e-19},  {1.8435e+00, 5.2640e-19},
      {1.8461e+00, 5.2192e-19},  {1.8486e+00, 5.1184e-19},
      {1.8511e+00, 5.0064e-19},  {1.8537e+00, 4.8832e-19},
      {1.8562e+00, 4.8048e-19},  {1.8588e+00, 4.7152e-19},
      {1.8613e+00, 4.6480e-19},  {1.8639e+00, 4.6032e-19},
      {1.8664e+00, 4.5584e-19},  {1.8690e+00, 4.4651e-19},
      {1.8715e+00, 4.1776e-19},  {1.8740e+00, 4.1664e-19},
      {1.8766e+00, 4.1664e-19},  {1.8791e+00, 3.8080e-19},
      {1.8817e+00, 3.7744e-19},  {1.8842e+00, 3.7296e-19},
      {1.8868e+00, 3.6736e-19},  {1.8893e+00, 3.5683e-19},
      {1.8919e+00, 3.4832e-19},  {1.8944e+00, 3.4608e-19},
      {1.8969e+00, 3.3376e-19},  {1.8995e+00, 3.2816e-19},
      {1.9020e+00, 3.1920e-19},  {1.9046e+00, 3.1136e-19},
      {1.9071e+00, 3.0352e-19},  {1.9097e+00, 3.0016e-19},
      {1.9122e+00, 2.9568e-19},  {1.9148e+00, 2.9456e-19},
      {1.9198e+00, 2.5872e-19},  {1.9224e+00, 2.5760e-19},
      {1.9249e+00, 2.5872e-19},  {1.9275e+00, 2.5760e-19},
      {1.9326e+00, 2.2400e-19},  {1.9351e+00, 2.2064e-19},
      {1.9377e+00, 2.1840e-19},  {1.9402e+00, 2.1392e-19},
      {1.9427e+00, 2.1056e-19},  {1.9453e+00, 2.0384e-19},
      {1.9478e+00, 1.9824e-19},  {1.9504e+00, 1.9152e-19},
      {1.9529e+00, 1.8704e-19},  {1.9555e+00, 1.8144e-19},
      {1.9580e+00, 1.7584e-19},  {1.9606e+00, 1.7136e-19},
      {1.9631e+00, 1.6688e-19},  {1.9656e+00, 1.6128e-19},
      {1.9682e+00, 1.5680e-19},  {1.9707e+00, 1.5344e-19},
      {1.9733e+00, 1.4672e-19},  {1.9758e+00, 1.4336e-19},
      {1.9784e+00, 1.3888e-19},  {1.9809e+00, 1.3664e-19},
      {1.9835e+00, 1.3552e-19},  {2.0013e+00, 9.9680e-20},
      {2.0038e+00, 9.9680e-20},  {2.0064e+00, 9.9680e-20},
      {2.0089e+00, 9.9680e-20},  {2.0344e+00, 6.4960e-20},
      {2.0369e+00, 6.4960e-20},  {2.0394e+00, 6.2720e-20},
      {2.0420e+00, 6.1600e-20},  {2.0445e+00, 5.9360e-20},
      {2.0471e+00, 5.7120e-20},  {2.0496e+00, 5.6000e-20},
      {2.0522e+00, 5.3760e-20},  {2.0547e+00, 5.1520e-20},
      {2.0573e+00, 5.0400e-20},  {2.0598e+00, 4.8160e-20},
      {2.0623e+00, 4.7040e-20},  {2.0649e+00, 4.4800e-20},
      {2.0674e+00, 4.3680e-20},  {2.0700e+00, 4.2560e-20},
      {2.0725e+00, 4.0320e-20},  {2.0751e+00, 3.9200e-20},
      {2.0776e+00, 3.8080e-20},  {2.0802e+00, 3.5840e-20},
      {2.0827e+00, 3.4720e-20},  {2.0852e+00, 3.3600e-20},
      {2.0878e+00, 3.3600e-20},  {2.0903e+00, 3.1360e-20},
      {2.0929e+00, 3.0240e-20},  {2.0954e+00, 2.9120e-20},
      {2.0980e+00, 2.8000e-20},  {2.1005e+00, 2.6880e-20},
      {2.1031e+00, 2.5760e-20},  {2.1056e+00, 2.4640e-20},
      {2.1081e+00, 2.3520e-20},  {2.1107e+00, 2.3520e-20},
      {2.1132e+00, 2.2400e-20},  {2.1158e+00, 2.1280e-20},
      {2.1183e+00, 2.0160e-20},  {2.1209e+00, 1.9040e-20},
      {2.1234e+00, 1.9040e-20},  {2.1260e+00, 1.7920e-20},
      {2.1285e+00, 1.7920e-20},  {2.1310e+00, 1.6800e-20},
      {2.1336e+00, 1.5680e-20},  {2.1361e+00, 1.5680e-20},
      {2.1387e+00, 1.5680e-20},  {2.1412e+00, 1.4560e-20},
      {2.1438e+00, 1.4560e-20},  {2.1743e+00, 7.8400e-21},
      {2.1768e+00, 7.8400e-21},  {2.1794e+00, 7.8400e-21},
      {2.1819e+00, 6.7200e-21},  {2.2125e+00, 3.3600e-21},
      {2.2150e+00, 3.3600e-21},  {2.2176e+00, 3.3600e-21},
      {2.2201e+00, 3.3600e-21},  {2.2226e+00, 3.3600e-21},
      {2.2252e+00, 2.2400e-21},  {2.2277e+00, 1.1200e-21},
      {2.2303e+00, 1.1200e-21},  {2.2328e+00, 1.1200e-21},
      {2.2354e+00, 1.1200e-21},  {2.2379e+00, 1.1200e-21},
      {2.2405e+00, 1.1200e-21},  {2.2430e+00, 1.1200e-21},
      {2.2455e+00, 1.1200e-21},  {2.2481e+00, 1.1200e-21},
      {2.2506e+00, 1.1200e-21},  {2.2532e+00, 1.1200e-21},
      {2.2557e+00, 1.1200e-21},  {2.2583e+00, 1.1200e-21},
      {2.2608e+00, 1.1200e-21},  {2.2634e+00, 1.1200e-21},
      {2.2659e+00, 1.1200e-21},  {2.2684e+00, 1.1200e-21},
      {2.2710e+00, 1.1200e-21},  {2.2735e+00, 1.1200e-21},
      {2.2761e+00, 1.1200e-21},  {2.2786e+00, 1.1200e-21},
      {2.2812e+00, 1.1200e-21},  {2.2837e+00, 1.1200e-21},
      {2.2863e+00, 1.1200e-21},  {2.2888e+00, 1.1200e-21},
      {2.2913e+00, 1.1200e-21},  {2.2939e+00, 0.0000e+00},
      {2.2964e+00, -1.1200e-21}, {2.2990e+00, -1.1200e-21},
      {2.3015e+00, -1.1200e-21}, {2.3041e+00, -1.1200e-21},
      {2.3066e+00, -1.1200e-21}, {2.3092e+00, -1.1200e-21},
      {2.3117e+00, -1.1200e-21}, {2.3142e+00, -1.1200e-21},
      {2.3168e+00, -1.1200e-21}, {2.3193e+00, -1.1200e-21},
      {2.3219e+00, -1.1200e-21}, {2.3244e+00, 0.0000e+00},
  };
  constexpr size_t data_size = sizeof(data) / sizeof(data[0]);

  wavelength *= real(1e6);  // in micro meter

  size_t left = 0;
  size_t right = data_size - 1;

  const auto [a, p] = data[left];
  if (wavelength <= a) return p;

  const auto [b, q] = data[right];
  if (wavelength >= b) return q;

  while (right - left > 1) {
    size_t middle = (right + left) / 2;
    const auto [x, y] = data[middle];
    if (wavelength <= x)
      right = middle;
    else
      left = middle;
  }

  const auto [x0, y0] = data[left];
  const auto [x1, y1] = data[right];
  return ((y1 - y0) / (x1 - x0) * (wavelength - x0) + y0) * real(1e-4);
}

}  // namespace craser::cr_zn_se
